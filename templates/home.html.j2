{% extends "base.html.j2" %}

{% block content %}
<div class="container mx-auto p-4 max-w-4xl">
    <h1 class="text-3xl font-bold text-white mb-6 text-center">Welcome, {{ session.handle }}! 🚀</h1>
    
    <!-- Lessons Section -->
    <div class="lessons-section mb-8">
        <h2 class="text-2xl font-semibold text-blue-100 mb-4 flex items-center">
            <span class="mr-2">📚</span>
            Your Lessons
        </h2>
        {% for lesson in lessons %}
        <div class="lesson-card bg-black p-5 rounded-xl shadow-lg border border-blue-200 hover:-translate-y-1 hover:shadow-xl transition-all duration-200 mb-4 max-w-lg mx-auto">
            <h3 class="text-xl font-semibold text-white mb-2">Lesson {{ lesson.id }}: {{ lesson.title or 'Untitled' }}</h3>
            <p class="text-gray-300 mb-4">{{ lesson.description or 'No description available.' }}</p>
            <div class="flex justify-end">
                <a href="{{ url_for('lessons') }}#lesson-{{ lesson.id }}" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-md font-semibold transition">Do Lesson</a>
            </div>
        </div>
        {% endfor %}
        {% if not lessons %}
        <div class="lesson-card bg-gray-800 p-6 rounded-xl shadow-lg border border-blue-200 text-center max-w-lg mx-auto">
            <h3 class="text-xl font-semibold text-white mb-2">No Lessons Scheduled Yet</h3>
            <p class="text-gray-300 mb-4">Ready to dive into learning? Schedule some fun lessons tailored to Grade {{ session.grade }}!</p>
            <form method="POST" action="{{ url_for('schedule_lessons') }}" style="display: inline;">
                <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold transition duration-200 flex items-center mx-auto">
                    <span class="mr-2">📅</span>
                    Schedule Lessons
                </button>
            </form>
            <p class="text-sm text-gray-400 mt-4">Click to add up to 3 new lessons to your feed.</p>
        </div>
        {% endif %}
    </div>

    <!-- Posts Section -->
    <div class="posts-section mb-8">
        <h2 class="text-2xl font-semibold text-blue-100 mb-4 flex items-center">
            <span class="mr-2">💬</span>
            Community Feed
        </h2>
        {% include 'posts.html.j2' %}
    </div>

    <!-- Recent Test -->
    {% include 'recent_test.html.j2' %}

    {% if subscribed %}
    <div class="bg-green-900 p-4 rounded-xl border border-green-500 text-center mb-6">
        <p class="text-green-100">⭐ Premium Subscriber: Enjoy unlimited lessons and games!</p>
    </div>
    {% endif %}
</div>
{% endblock %}