{% extends "base.html.j2" %}

{% block title %}Parent Dashboard - EduGrok{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto p-6">
    <h1 class="text-3xl font-bold mb-6 text-center text-grok-text">Parent Dashboard</h1>
    
    {% if error %}
        <div class="text-center py-4">
            <p class="text-red-400 text-lg">{{ error }}</p>
            <a href="{{ url_for('login') }}" class="bg-grok-accent text-grok-text px-4 py-2 rounded-md hover:bg-grok-accent-hover transition inline-flex items-center shadow-md mt-4">Log In Again</a>
        </div>
    {% else %}
        <div class="card bg-grok-surface p-5 rounded-xl shadow-lg border border-grok-border hover:-translate-y-1 hover:shadow-xl transition-all duration-200 mb-6">
            <h2 class="text-xl font-semibold text-grok-text mb-4">Welcome, Parent!</h2>
            <p class="text-grok-secondary text-base mb-4">Monitor your child's progress, view their achievements, and manage their learning activities.</p>
        </div>

        <!-- Child Progress Section -->
        <div class="card bg-grok-surface p-5 rounded-xl shadow-lg border border-grok-border hover:-translate-y-1 hover:shadow-xl transition-all duration-200 mb-6">
            <h3 class="text-lg font-semibold text-grok-text mb-4">Child Progress</h3>
            <p class="text-grok-text text-base mb-2"><strong>Lessons Completed:</strong> {{ lessons_completed | default(0) }}</p>
            <p class="text-grok-text text-base mb-2"><strong>Games Played:</strong> {{ games_played | default(0) }}</p>
            <p class="text-grok-text text-base"><strong>Average Test Score:</strong> {{ avg_score | default('N/A') }}</p>
        </div>

        <!-- Badges Section -->
        <div class="card bg-grok-surface p-5 rounded-xl shadow-lg border border-grok-border hover:-translate-y-1 hover:shadow-xl transition-all duration-200 mb-6">
            <h3 class="text-lg font-semibold text-grok-text mb-4">Badges Earned</h3>
            {% if badges %}
                <div class="flex flex-wrap gap-2">
                    {% for badge in badges %}
                        <span class="bg-yellow-900/50 text-yellow-100 px-3 py-1 rounded-full text-sm font-medium shadow-sm">{{ badge.badge_name }} ({{ badge.awarded_date }})</span>
                    {% endfor %}
                </div>
            {% else %}
                <p class="text-grok-secondary text-base">No badges earned yet. Encourage your child to keep learning!</p>
            {% endif %}
        </div>

        <!-- Recent Tests Section -->
        <div class="card bg-grok-surface p-5 rounded-xl shadow-lg border border-grok-border hover:-translate-y-1 hover:shadow-xl transition-all duration-200 mb-6">
            <h3 class="text-lg font-semibold text-grok-text mb-4">Recent Tests</h3>
            {% if tests %}
                {% for test in tests %}
                    <p class="text-grok-text text-base mb-2"><strong>Grade:</strong> {{ test.grade | default('N/A') }} - <strong>Score:</strong> {{ test.score | default('N/A') }}/10 - <strong>Date:</strong> {{ test.date | default('Unknown') }}</p>
                {% endfor %}
            {% else %}
                <p class="text-grok-secondary text-base">No tests taken yet.</p>
            {% endif %}
        </div>

        <!-- Feedback Section -->
        <div class="card bg-grok-surface p-5 rounded-xl shadow-lg border border-grok-border hover:-translate-y-1 hover:shadow-xl transition-all duration-200 mb-6">
            <h3 class="text-lg font-semibold text-grok-text mb-4">Feedback History</h3>
            {% if feedbacks %}
                {% for feedback in feedbacks %}
                    <p class="text-grok-text text-base mb-2"><strong>Rating:</strong> {{ feedback.rating | default('N/A') }} - <strong>Comments:</strong> {{ feedback.comments | default('None') }} - <strong>Date:</strong> {{ feedback.submitted_date | default('Unknown') }}</p>
                {% endfor %}
            {% else %}
                <p class="text-grok-secondary text-base">No feedback submitted yet. <a href="{{ url_for('feedback') }}" class="bg-grok-accent text-grok-text px-4 py-2 rounded-md hover:bg-grok-accent-hover transition inline-flex items-center shadow-md">Submit Feedback</a></p>
            {% endif %}
        </div>

        <!-- Actions Section -->
        <div class="card bg-grok-surface p-5 rounded-xl shadow-lg border border-grok-border hover:-translate-y-1 hover:shadow-xl transition-all duration-200 mb-6">
            <h3 class="text-lg font-semibold text-grok-text mb-4">Actions</h3>
            <div class="flex flex-wrap gap-4">
                <a href="{{ url_for('lessons') }}" class="bg-grok-accent text-grok-text px-4 py-2 rounded-md hover:bg-grok-accent-hover transition shadow-md">Assign Lessons</a>
                <a href="{{ url_for('assess') }}" class="bg-grok-accent text-grok-text px-4 py-2 rounded-md hover:bg-grok-accent-hover transition shadow-md">View Assessments</a>
                <a href="{{ url_for('games') }}" class="bg-grok-accent text-grok-text px-4 py-2 rounded-md hover:bg-grok-accent-hover transition shadow-md">View Games</a>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}