<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EduGrok Educational Stream</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body class="{{ theme }}">
    <h1>EduGrok Educational Stream</h1>
    {% if error %}
        <p style="color: red;">{{ error }}</p>
    {% endif %}
    {% if not subscribed %}
        <a href="/subscribe" class="btn">Subscribe for Premium ($5/month)</a>
    {% endif %}
    <a href="/logout" class="btn">Logout</a>
    <a href="/profile" class="btn">Profile</a>
    <a href="/lessons" class="btn">Lessons</a>

    {% if lesson %}
        <div class="lesson-card">
            <h2>{{ lesson['subject'] }} Lesson</h2>
            {{ lesson['content'] | safe }}
            <a href="/complete_lesson/{{ lesson['id'] }}" class="btn">Complete Lesson</a>
            {% if lesson['subject'] == 'language' %}
                <a href="/phonics_game" class="btn">Play Phonics Game!</a>
            {% endif %}
        </div>
    {% endif %}

    {% if test %}
        <div class="lesson-card">
            <h2>Weekly Test (Grade {{ test['grade'] }})</h2>
            <p>Score: {{ test['score'] }} | Taken: {{ test['date'] }}</p>
            <a href="/game?score={{ test['score'] }}" class="btn">Play Boss Battle</a>
        </div>
    {% else %}
        <a href="/test" class="btn">Take Weekly Test</a>
    {% endif %}

    <h2>Stream</h2>
    {% for post in posts %}
        <div class="feed-post">
            <strong>{{ post.handle }} ({{ post.subject }}):</strong> {{ post.content }}
            <p>Likes: {{ post.likes }} <a href="/like/{{ post.id }}" class="like-btn">❤️ Like</a> <a href="/report/{{ post.id }}" class="btn">Report</a></p>
        </div>
    {% endfor %}
</body>
</html>